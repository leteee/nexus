# Nexus Framework - Global Configuration
# =======================================================================
# Framework-wide defaults and plugin configurations.
#
# Configuration Hierarchy (4 layers, highest to lowest precedence):
#   1. CLI overrides (--config key=value)
#   2. Case OR Template config (mutual exclusion)
#   3. Global config (this file)
#   4. Plugin defaults (from PluginConfig classes)
# =======================================================================

framework:
  name: "nexus"
  version: "1.0.0"

  # Cases root directories (searched in priority order)
  cases_roots:
    - "cases"

  # Template root directories (searched in priority order)
  templates_roots:
    - "templates"

  # Plugin discovery paths
  # Each path points to a package directory containing:
  #   - Business logic (framework-independent)
  #   - nexus/ submodule (adapters with @plugin decorators)
  #
  # Discovery process:
  #   1. Add parent directory to sys.path
  #   2. Import package_name (directory name)
  #   3. Auto-import package_name.nexus if exists
  #
  packages:
    - "src/nexus/contrib"  # Built-in plugins

  # Sideload external plugins:
  # Add paths in config/local.yaml (see local.yaml.example)

  # Logging
  logging:
    level: INFO  # DEBUG, INFO, WARNING, ERROR
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

  # Performance
  performance:
    default_cache_size: 100  # MB
    lazy_loading: true
    max_concurrent_plugins: 4

# Global Plugin Configuration
# Provides fallback defaults for all plugins when not specified elsewhere
# IMPORTANT: Configure plugin behavior in templates/cases for actual use
plugins:
  # Data Generation Plugins
  "Data Generator":
    num_rows: 1000        # Number of rows to generate
    random_seed: 42       # For reproducible results
    num_categories: 3     # Number of categories in categorical columns
    noise_level: 0.1      # Amount of noise to add (0.0 to 1.0)

# ========================================================================
# Configuration Best Practices
# ========================================================================
#
# 1. Plugin I/O Configuration:
#    - All I/O paths are declared in plugin config classes with DataSource/DataSink annotations
#    - Users override I/O paths in YAML config alongside behavior parameters
#    - No separate data_sources or outputs sections needed in most cases
#
#    Example plugin config:
#      class MyPluginConfig(PluginConfig):
#          input_data: Annotated[str, DataSource(handler="csv")] = "data/input.csv"
#          output_data: Annotated[str, DataSink(handler="csv")] = "data/output.csv"
#          threshold: float = 0.5
#
#    Example YAML usage:
#      pipeline:
#        - plugin: "My Plugin"
#          config:
#            input_data: "custom/path/input.csv"   # Override I/O path
#            output_data: "custom/path/output.csv" # Override I/O path
#            threshold: 0.8                        # Override behavior param
#
# 2. Global data_sources (Optional):
#    - Only use for shared external data sources accessed by multiple plugins
#    - Reference with special syntax: "source:name"
#    - Most pipelines don't need this
#
#    Example (advanced use case):
#      data_sources:
#        customer_master:
#          handler: csv
#          path: "/shared/customers.csv"
#          read_only: true
#
#      pipeline:
#        - plugin: "Enricher"
#          config:
#            customer_data: "source:customer_master"  # Reference global source
#            output_data: "data/enriched.csv"
#
# 3. Configuration Hierarchy (4 layers):
#    CLI overrides > Case/Template config > Global config > Plugin defaults
#
#    Note: Case and Template are mutually exclusive (not merged):
#    - With --template: Use template, ignore case.yaml
#    - Without --template: Use case.yaml
#
# 4. Where to configure plugins:
#    - Global config (plugins.*): Organization-wide defaults only
#    - Templates: Reusable pipeline patterns (RECOMMENDED)
#    - Case configs: Case-specific customizations
#    - CLI: Quick experimentation and overrides
#
# 5. Configuration Namespaces:
#    - framework.*: Framework settings (logging, performance, discovery)
#    - data_sources.*: Global/shared data sources (optional, for cross-pipeline use)
#    - plugins.*: Plugin behavior defaults
#    - pipeline: Pipeline definition (in templates/cases only)
#    - meta: Metadata (name, description, in templates/cases only)
# ========================================================================


